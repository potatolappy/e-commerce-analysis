# storing new tables inside the database

CREATE TABLE olist_analysis (
	product_id TEXT,
    	seller_id TEXT,
    	category_name TEXT,
    	city TEXT,
    	price FLOAT,
    	freight_value FLOAT
)

# inserting data into the new table

INSERT INTO olist_analysis (
	product_id TEXT,
    	seller_id TEXT,
    	category_name TEXT,
    	city TEXT,
    	price FLOAT,
    	freight_value FLOAT
)

SELECT 
	olist_order_items_dataset.product_id,
	olist_order_items_dataset.seller_id,
	olist_sellers_dataset.seller_city,
	olist_order_items_dataset.price,
	olist_order_items_dataset.freight_value,
	olist_products_dataset.product_category_name
FROM 
	olist_order_items_dataset
LEFT JOIN 
	olist_sellers_dataset ON olist_order_items_dataset.seller_id = olist_sellers_dataset.seller_id
LEFT JOIN
        olist_products_dataset ON olist_order_items_dataset.product_id = olist_products_dataset.product_id
